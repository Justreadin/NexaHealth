<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drug Verification | NexaHealth</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" type="image/png" href="/favicon.png">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/verify.css">
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm p-4 sticky top-0 z-20">
        <div class="flex items-center justify-between max-w-6xl mx-auto">
            <a href="dashboard.html" class="text-blue-600 font-bold text-lg">
                <i class="fas fa-chevron-left mr-2"></i>
            </a>
            <div class="flex items-center">
                <h1 class="text-xl font-bold font-serif text-gray-800">Verify Drugs</h1>
            </div>
            <div class="w-6"></div> <!-- Spacer -->
        </div>
    </header>

    <main class="max-w-md mx-auto pb-20 px-4">
        <!-- Verification Hero -->
        <div class="health-gradient rounded-2xl p-6 text-white mb-8 mt-6 shadow-lg overflow-hidden relative">
            <div class="absolute inset-0 opacity-10">
                <div class="absolute top-0 left-10 w-20 h-20 rounded-full bg-white"></div>
                <div class="absolute bottom-0 right-10 w-32 h-32 rounded-full bg-white"></div>
            </div>
            <div class="relative z-10">
                <div class="flex items-center mb-4">
                    <div class="bg-white bg-opacity-20 p-3 rounded-full mr-4">
                        <i class="fas fa-shield-alt text-xl"></i>
                    </div>
                    <h2 class="text-xl font-bold font-serif">Medication Safety Check</h2>
                </div>
                <p class="text-sm opacity-90 mb-6">Verify authenticity and safety of your medications</p>
                <div class="flex space-x-3">
                    <a href="#scan-section" class="scan-pulse inline-flex items-center justify-center bg-white text-blue-600 px-4 py-2.5 rounded-full text-sm font-medium shadow-lg hover:shadow-xl transition-all">
                        <i class="fas fa-barcode mr-2"></i> Scan Now
                    </a>
                    <a href="#manual-section" class="inline-flex items-center justify-center border border-white text-white px-4 py-2.5 rounded-full text-sm font-medium hover:bg-white hover:bg-opacity-10 transition-colors">
                        <i class="fas fa-keyboard mr-2"></i> Enter Manually
                    </a>
                </div>
            </div>
        </div>

        <!-- Scan Section -->
        <section id="scan-section" class="mb-8 slide-in relative">

        <!-- Overlay -->
        <div class="absolute inset-0 z-10  flex items-center justify-center pointer-events-none">
            <span class="text-xl sm:text-2xl font-bold text-gray-700">Coming Soon</span>
        </div>

        <!-- Existing Content -->
        <div class="opacity-30 pointer-events-none"> <!-- Dimmed and non-interactive -->
            <div class="flex items-center justify-between mb-4">
            <h2 class="text-lg font-bold font-serif flex items-center text-gray-800">
                <i class="fas fa-barcode mr-2 text-blue-600"></i>
                Barcode Scan
            </h2>
            </div>

            <div class="drug-card bg-white rounded-xl shadow-sm p-6 text-center border border-gray-100 relative overflow-hidden">
            <div class="absolute top-0 right-0 bg-blue-600 text-white text-xs px-2 py-1 rounded-bl-lg">
                FASTEST
            </div>
            <div class="bg-blue-50 p-5 rounded-xl inline-block mb-4">
                <i class="fas fa-barcode text-blue-600 text-4xl"></i>
            </div>
            <h3 class="font-bold mb-2 text-gray-800">Scan Drug Packaging</h3>
            <p class="text-sm text-gray-600 mb-4">Position the barcode within the camera frame</p>
            <button id="open-scanner" class="w-full health-gradient hover:opacity-90 text-white py-3 rounded-lg font-medium transition-all flex items-center justify-center">
                <i class="fas fa-camera mr-2"></i> Open Scanner
            </button>
            </div>
        </div>

        </section>

        <!-- Manual Input Section -->
        <section id="manual-section" class="mb-8 slide-in" style="animation-delay: 0.1s">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-lg font-bold font-serif flex items-center text-gray-800">
                    <i class="fas fa-keyboard mr-2 text-blue-600"></i>
                    Manual Verification
                </h2>
            </div>
            
            <div class="drug-card bg-white rounded-xl shadow-sm p-6 border border-gray-100">
                <div class="flex items-center mb-4">
                    <div class="bg-blue-100 p-3 rounded-full mr-3">
                        <i class="fas fa-keyboard text-blue-600"></i>
                    </div>
                    <h3 class="font-bold text-gray-800">Enter Drug Details</h3>
                </div>
                
                <form id="manual-verify-form">
                    <!-- Drug Name Field with Autocomplete -->
                    <div class="mb-4 relative">
                        <label class="block text-sm font-medium text-gray-700 mb-1 flex items-center justify-between">
                            <span>Drug Name</span>
                            <span class="text-xs text-blue-600">Required</span>
                        </label>
                        <div class="relative">
                            <input type="text" id="drug-name" placeholder="e.g. Paracetamol 500mg" 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all"
                                   autocomplete="off">
                            <div id="autocomplete-results" class="absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg hidden max-h-60 overflow-y-auto">
                                <!-- Autocomplete items will be inserted here -->
                            </div>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">Start typing to see suggestions</p>
                    </div>
                    
                    <!-- Manufacturer Field -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Manufacturer (Optional)</label>
                        <input type="text" id="manufacturer" placeholder="e.g. Emzor Pharmaceuticals" 
                            class="w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 focus:ring-1 focus:ring-blue-500">
                    </div>
                    
                    <!-- NAFDAC Number Field -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-1">NAFDAC Number</label>
                        <input type="text" id="nafdac-number" placeholder="e.g. 04-0163" 
                               class="w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 focus:ring-1 focus:ring-blue-500">
                        <p class="text-xs text-gray-500 mt-1">8-digit number usually found on packaging</p>
                    </div>
                    
                    <!-- Confidence Indicator -->
                    <div class="mb-4 bg-blue-50 rounded-lg p-3">
                        <div class="flex items-center justify-between mb-1">
                            <span class="text-xs font-medium text-blue-800">Verification Confidence</span>
                            <span id="confidence-value" class="text-xs font-bold text-blue-600">0%</span>
                        </div>
                        <div class="w-full bg-blue-100 rounded-full h-2">
                            <div id="confidence-bar" class="bg-blue-500 h-2 rounded-full" style="width: 0%"></div>
                        </div>
                        <p id="confidence-text" class="text-xs text-blue-700 mt-1">Enter more details to improve accuracy</p>
                    </div>
                    
                    <button type="submit" class="w-full health-gradient hover:opacity-90 text-white py-3 rounded-lg font-medium transition-all flex items-center justify-center">
                        <i class="fas fa-shield-alt mr-2"></i> Verify Medication
                    </button>
                </form>
            </div>
        </section>

        <!-- Camera Scanner Modal -->
        <div id="scanner-modal" class="fixed inset-0 bg-black z-50 hidden">
            <div class="relative h-full">
                <!-- Camera Preview -->
                <div class="h-full flex flex-col items-center justify-center relative">
                    <div class="absolute top-4 left-4 z-10">
                        <button id="close-scanner" class="bg-black bg-opacity-50 text-white p-2 rounded-full">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="text-center text-white mb-8 z-10">
                        <i class="fas fa-barcode text-5xl mb-4 text-blue-400"></i>
                        <p class="text-lg font-medium">Align barcode within the frame</p>
                        <p class="text-sm opacity-80 mt-1">Ensure good lighting and steady hands</p>
                    </div>
                    
                    <!-- Scanner Frame -->
                    <div class="relative w-64 h-40 mb-8 z-10">
                        <div class="absolute inset-0 border-4 border-blue-400 rounded-lg opacity-80"></div>
                        <div class="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-16 h-1 bg-blue-400 rounded-full"></div>
                        <div class="absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-1/2 w-16 h-1 bg-blue-400 rounded-full"></div>
                    </div>
                </div>
                
                <!-- Scanner Controls -->
                <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-70 p-4 z-10">
                    <div class="flex justify-center mb-4">
                        <button id="toggle-flash" class="bg-gray-800 bg-opacity-50 text-white p-3 rounded-full mx-2 hover:bg-opacity-70 transition">
                            <i class="fas fa-bolt"></i>
                        </button>
                        <button id="switch-camera" class="bg-gray-800 bg-opacity-50 text-white p-3 rounded-full mx-2 hover:bg-opacity-70 transition">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                    <button id="capture-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-medium transition-colors flex items-center justify-center">
                        <i class="fas fa-camera mr-2"></i> Capture Barcode
                    </button>
                </div>
            </div>
        </div>

        <!-- Verification Results Modal -->
        <div id="results-modal" class="fixed inset-0 bg-white z-50 hidden overflow-y-auto">
            <div class="relative min-h-full">
                <div class="sticky top-0 bg-white p-4 shadow-sm flex items-center z-10">
                    <button id="close-results" class="text-gray-500 mr-4">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <h2 class="font-bold text-lg font-serif text-gray-800">Verification Result</h2>
                </div>
                
                <div class="p-6">
                    <!-- Verification Status (Dynamic) -->
                    <div id="verification-status-container" class="rounded-xl p-5 mb-6 text-center border-2">
                        <div class="flex justify-center mb-3">
                            <div id="status-icon" class="p-3 rounded-full text-2xl">
                                <i class="fas fa-circle-notch fa-spin"></i>
                            </div>
                        </div>
                        <h3 id="status-title" class="font-bold text-lg mb-1">Verifying Medication</h3>
                        <p id="status-message" class="text-sm">Please wait while we verify your medication</p>
                    </div>
                    
                    <!-- Drug Card -->
                    <div class="bg-white rounded-xl shadow-md border border-gray-100 mb-6 overflow-hidden">
                        <!-- Drug Header -->
                        <div class="bg-blue-50 p-4 flex items-center">
                            <div class="bg-blue-100 p-3 rounded-lg mr-4">
                                <i class="fas fa-pills text-blue-600 text-xl"></i>
                            </div>
                            <div>
                                <h3 id="drug_name" class="font-bold text-gray-800 text-lg"></h3>
                                <p id="drug-manufacturer" class="text-gray-600 text-sm"></p>
                            </div>
                        </div>
                        
                        <!-- Drug Details -->
                        <div class="p-4">
                            <!-- Trust Score -->
                            <div class="mb-4">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-sm font-medium text-gray-700">Trust Score</span>
                                    <span id="trust-score-value" class="text-sm font-bold">0%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2.5 mb-2">
                                    <div id="trust-score-bar" class="h-2.5 rounded-full"></div>
                                </div>
                                <p id="trust-score-text" class="text-xs text-gray-500">Verification confidence level</p>
                            </div>
                            
                            <!-- Crowd Reports -->
                            <div id="crowd-reports-container" class="bg-blue-50 rounded-lg p-3 mb-4">
                                <div class="flex items-center">
                                    <div class="bg-blue-100 p-2 rounded-full mr-3">
                                        <i class="fas fa-users text-blue-600"></i>
                                    </div>
                                    <div>
                                        <p id="crowd-report-text" class="text-sm font-medium text-blue-800 mb-1"></p>
                                        <p class="text-xs text-blue-700">Community safety reports</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Verification Info -->
                            <div id="verification-info-container" class="hidden bg-green-50 rounded-lg p-3 mb-4">
                                <div class="flex items-center">
                                    <div class="bg-green-100 p-2 rounded-full mr-3">
                                        <i class="fas fa-shield-alt text-green-600"></i>
                                    </div>
                                    <div>
                                        <p id="verification-info-text" class="text-sm font-medium text-green-800 mb-1"></p>
                                        <p id="verification-date" class="text-xs text-green-700"></p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Detailed Info -->
                            <div class="grid grid-cols-2 gap-3 mb-4">
                                <div class="bg-gray-50 p-3 rounded-lg">
                                    <p class="text-xs text-gray-500">NAFDAC Number</p>
                                    <p id="nafdac_number" class="text-sm font-medium">-</p>
                                </div>
                                <div class="bg-gray-50 p-3 rounded-lg">
                                    <p class="text-xs text-gray-500">Dosage Form</p>
                                    <p id="dosage-form" class="text-sm font-medium">-</p>
                                </div>
                                <div class="bg-gray-50 p-3 rounded-lg">
                                    <p class="text-xs text-gray-500">Strength</p>
                                    <p id="drug-strength" class="text-sm font-medium">-</p>
                                </div>
                                <div class="bg-gray-50 p-3 rounded-lg">
                                    <p class="text-xs text-gray-500">Last Verified</p>
                                    <p id="last-verified" class="text-sm font-medium">-</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div id="action-buttons-container" class="space-y-3">
                        <!-- Will be filled dynamically -->
                    </div>
                    
                    <!-- Possible Matches -->
                    <div id="possible-matches-container" class="hidden mt-6">
                        <h4 class="font-bold mb-3 text-gray-800 flex items-center">
                            <i class="fas fa-lightbulb text-yellow-500 mr-2"></i>
                            Similar Medications
                        </h4>
                        <div id="possible-matches-list" class="space-y-3">
                            <!-- Will be filled dynamically -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- PIL Modal -->
        <div id="pil-modal" class="fixed inset-0 bg-white z-50 hidden overflow-y-auto">
            <div class="relative min-h-full">
                <div class="sticky top-0 bg-white p-4 shadow-sm flex items-center z-10">
                    <button id="close-pil" class="text-gray-500 mr-4">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <h2 class="font-bold text-lg font-serif text-gray-800">Product Leaflet</h2>
                    <div class="ml-auto flex space-x-2">
                        <button id="download-pil" class="p-2 text-blue-600 hover:bg-blue-50 rounded-full">
                            <i class="fas fa-download"></i>
                        </button>
                        <button id="save-pil" class="p-2 text-blue-600 hover:bg-blue-50 rounded-full">
                            <i class="fas fa-bookmark"></i>
                        </button>
                    </div>
                </div>
                
                <div class="p-6" id="pil-modal-content">
                    <!-- Content will be loaded dynamically -->
                    <div class="flex justify-center items-center h-64">
                        <div class="loader"></div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <script src="js/login.js"></script>
    <script src="js/pil-viewer.js"></script>
    <script src="js/verify.js"></script>
</body>
</html>